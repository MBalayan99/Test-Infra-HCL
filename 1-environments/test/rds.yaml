source: "dasmeta/rds/aws"
version: "1.4.0"

variables:
  identifier: rds-instance
  engine: mysql
  engine_version: "8.0"
  instance_class: db.t2.micro
  allocated_storage: 20
  storage_type: gp2
  storage_encrypted: true
  multi_az: false
  db_name: testdb
  db_username: admin
  db_password: Test1234!
  port: 3306
  publicly_accessible: false
  backup_retention_period: 7

  vpc_security_group_ids:
    - ${linked_workspaces.rds-sg.outputs.rds_security_group_id}

  subnet_ids: ${linked_workspaces.vpc.outputs.private_subnets}

  tags:
    Environment: test
    Project: Test-Infra-HCL
    Owner: mher-test

providers:
  - name: aws
    version: "~> 5.0"
    module_nested_provider: true
    variables:
      region: eu-central-1
      default_tags:
        tags:
          Account: mher-test
          ManageLevel: environment

linked_workspaces:
  - "1-environments/test/vpc"
  - "1-environments/test/rds-sg"
source: "dasmeta/rds/aws"
version: "1.4.0"

variables:
  identifier: rds-instance
  engine: mysql
  engine_version: "8.0"
  instance_class: db.t2.micro
  allocated_storage: 20
  storage_type: gp2
  storage_encrypted: true
  multi_az: false
  db_name: testdb
  db_username: admin
  db_password: Test1234!
  port: 3306
  publicly_accessible: false
  backup_retention_period: 7

  vpc_security_group_ids:
    - ${linked_workspaces.rds-sg.outputs.rds_security_group_id}

  subnet_ids: ${linked_workspaces.vpc.outputs.private_subnets}

  tags:
    Environment: test
    Project: Test-Infra-HCL
    Owner: mher-test

providers:
  - name: aws
    version: "~> 5.0"
    module_nested_provider: true
    variables:
      region: eu-central-1
      default_tags:
        tags:
          Account: mher-test
          ManageLevel: environment

linked_workspaces:
  - "1-environments/test/vpc"
  - "1-environments/test/rds-sg"
